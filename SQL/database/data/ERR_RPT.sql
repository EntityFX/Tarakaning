INSERT INTO ERR_RPT VALUES 
  (2, 3, 2, 'Defect', '1', 'CLOSED', '2011-02-06 18:05:52', 'Возник BSOD', 'При попытке вызвать экран, вышла критическая ошибка', NULL),
  (3, 10, 3, 'Defect', '1', 'NEW', '2011-02-17 19:57:46', '', 'dsvfdgfdgdfg', NULL),
  (4, 3, 1, 'Defect', '1', 'ASSESSED', '2011-02-17 19:58:23', 'dfdsfd', 'dsfsdf', NULL),
  (5, 3, 2, 'Defect', '2', 'IDENTIFIED', '2011-02-17 20:12:23', 'sdfsd', 'sdfsadfasdfsdaf', NULL),
  (6, 3, 1, 'Defect', '1', 'NEW', '2011-02-24 23:19:28', 'Взрыв', '', NULL),
  (7, 3, 7, 'Defect', '2', 'NEW', '2011-02-24 23:20:08', 'Уничтожение', '', NULL),
  (8, 10, 3, 'Defect', '0', 'IDENTIFIED', '2011-02-24 23:20:24', 'Закрытие', '', NULL),
  (10, 1, 2, 'Defect', '1', 'CLOSED', '2011-02-26 23:40:22', '', '', NULL),
  (11, 3, 6, 'Defect', '1', 'NEW', '2011-02-27 03:32:03', 'fsdfsdf', '', NULL),
  (12, 3, 6, 'Defect', '2', 'ASSESSED', '2011-02-27 03:34:34', 'sdfdsf', '', NULL),
  (13, 3, 11, 'Defect', '0', 'NEW', '2011-02-28 00:41:17', 'Искривление зеркала', '', NULL),
  (14, 13, 1, 'Defect', '2', 'RESOLVED', '2011-09-02 01:08:44', 'OK', '', NULL),
  (15, 3, 1, 'Defect', '2', 'NEW', '2011-09-04 14:14:54', '', '', NULL),
  (16, 13, 1, 'Defect', '2', 'NEW', '2011-09-04 14:26:32', '', '', NULL),
  (17, 13, 1, 'Defect', '2', 'NEW', '2011-09-04 14:27:02', '', '', NULL),
  (18, 13, 1, 'Defect', '2', 'NEW', '2011-09-04 14:44:24', 'Заголовок', '', NULL),
  (19, 13, 1, 'Defect', '2', 'ASSESSED', '2011-09-04 14:51:07', 'Заголовок', '', NULL),
  (20, 13, 1, 'Defect', '2', 'NEW', '2011-09-04 14:53:52', 'Заголовок', '', NULL),
  (21, 13, 1, 'Defect', '2', 'IDENTIFIED', '2011-09-04 14:54:44', 'Заголовок', '', NULL),
  (22, 13, 1, 'Defect', '2', 'NEW', '2011-09-04 15:31:15', '', '', NULL),
  (23, 13, 1, 'Defect', '2', 'NEW', '2011-09-04 15:31:23', '', '', NULL),
  (31, 13, 21, 'Defect', '1', 'NEW', '2011-09-04 16:52:49', 'апрвапрвапрвапрвпарвапр', '', NULL),
  (43, 1, 23, 'Defect', '2', 'NEW', '2011-09-15 00:41:45', 'fghfghfghghf', 'tgrhgfh', 1),
  (71, 18, 48, 'Task', '0', 'RESOLVED', '2011-10-06 00:55:55', 'Реализовать выделение текущего раздела меню', 'В настоящий момент меня всегда выделяется на разделе &quot;Мои отчёты&quot;. Нужно, чтобы выделялся на текущем.', 1),
  (72, 1, 48, 'Task', '2', 'RESOLVED', '2011-10-06 02:24:18', 'Реализовать возможность нзначения айтема на пользователя текущего проекта', 'Должно работать поле, которое при выборе проекта обновляется и содержит список всех участников проекта, включая владельца. Логин создающего данный айтем должно находиться на первом месте, также если пустое значение, то айтем не будет назначен кому-либо.', 1),
  (73, 1, 48, 'Task', '1', 'RESOLVED', '2011-10-06 02:29:50', 'Удаление всех выделенных айтемов из грида в Моих отчётах', '1. Переходим на страницу Мои отчёты.\r\n2. Пользователь должен удалять все выделенные айтемы в гриде, нажав чекбокс в вернем углу грида. При нажатии &quot;Удалить выделенные&quot; должно быть показано диалоговое окно подтверждения. \r\n3. Если нажато [Да] - у', 1),
  (76, 1, 48, 'Defect', '0', 'RESOLVED', '2011-10-06 02:52:31', 'В комментариях у грида не подсвечивается текущее поле, по которому сортируем', 'Поле грида, по которому сортируем, должно выделяться в красный цвет.', 1),
  (77, 18, 48, 'Defect', '2', 'RESOLVED', '2011-10-06 03:01:38', 'Если отсутствует скомпилированный шаблон для страниц &quot;Мои отчёты&quot; и &quot;Отчёты проекта&quot;, происходит исключение в Apache', 'Краш отчёт:\r\n\r\nСигнатура проблемы:\r\n  Имя события проблемы:\tAPPCRASH\r\n  Имя приложения:\thttpd.exe\r\n  Версия приложения:\t2.2.4.0\r\n  Отметка времени приложения:\t45a476e3\r\n  Имя модуля с ошибкой:\tphp5ts.dll\r\n  Версия модуля с ошибкой:\t5.2.4.4\r\n  Отметка врем', 1),
  (78, 18, 48, 'Defect', '1', 'CLOSED', '2011-10-06 03:05:15', 'При создании айтема урезается текст в полях ', 'Текст после создания айтема урезается, что неверно. Нужно увеличить до 1024 символов поля "Описание" и "Действия, которые привели к ошибке".\r\n\r\nНадо пофиксить.', 1),
  (79, 1, 48, 'Task', '2', 'RESOLVED', '2011-10-06 21:56:30', 'Редактирование статуса айтема', 'Сделать возможность редактирования айтема при просмотре. Менять состояние может только владелец айтема, на кого заасайненно и владелец проекта. Закрыть айтем может только владелец айтема и владелец проекта. При отображении состояния показывается текущее и', 1),
  (80, 1, 48, 'Task', '2', 'ASSESSED', '2011-10-06 22:02:55', 'Отображение заявок на проект', 'Сделать отображения всех запросов на вступление в проект, называемые "Заявки".\r\n\r\nОтображение имени пользователя, даты подачи заявки и кнопок "Подтвердить" и "Отклонить".\r\n\r\nСделать чекбоксы для грида, которые позволяют подтв', 1),
  (82, 1, 48, 'Task', '2', 'RESOLVED', '2011-10-06 22:08:45', 'Поиск проектов', 'Реализовать полнотекстовый поиск по проекту и его описанию. На первом месте должны находиться проекты более совпадающие с поисковым критерием. \r\n\r\nПри удалении проекта - удалять полнотекстовый индекс проекта. Если у проекта пользователь был удалён, то ото', 1),
  (83, 1, 48, 'Task', '1', 'NEW', '2011-10-06 22:14:28', 'В настройках профиля добавить вкладку Дополнительные настройки', 'В данной вкладке добавить выпадающий список, который настраивает проект по-умолчанию. Для это есть специальный метод в классе ConcreteUser (бизнес-логика) ConcreteUser ::setDefaultProject($projectID), ConcreteUser::deleteDefaultProject().\r\n\r\nВ выпадающем ', 18),
  (84, 1, 48, 'Defect', '1', 'RESOLVED', '2011-10-06 22:29:37', 'Обрезается текст и заголовок при создании дефекта', 'При превышении размера в 256 символов - обрезается текст в описании и действиях, которые привели к ошибке. В хранимую процедуру AddItem стоит ограничение на входной текст.', 1),
  (85, 1, 48, 'Task', '0', 'RESOLVED', '2011-10-06 22:33:58', 'Добавить возможность замены переносов на &lt;br/&gt;', 'Текст линейно отображается, было бы неплохо добавлять реальне переносы строки.', 1),
  (87, 1, 48, 'Defect', '1', 'CLOSED', '2011-10-09 04:09:33', 'Перевести меню на компонент', 'Текущая менюшка статическая и не меняет текущий номер', 1),
  (88, 18, 48, 'Task', '1', 'NEW', '2011-10-09 13:45:49', 'Сделать подсветку пунктов', 'При наведении курсора на пункты необходимо сделать подсветку (opacity либо мануальное проставление цвета)', 18),
  (91, 1, 48, 'Defect', '1', 'CLOSED', '2011-10-09 14:16:06', 'Не могу менять Проекты в выпадающем списке в "Мои Отчёты" и "Отчёты проекта"', 'Если произошёл POST запрос, то ставим тот проект, который был выбран из списка', 1),
  (106, 1, 48, 'Defect', '2', 'CLOSED', '2011-10-10 01:34:01', 'Смена пароля неправильно реализована', 'При смене пароля, даже если не введён старый пароль, изменения сохраняются.\r\nТакже Имя, Фамилия, Отчество, Время входа становятся пустыми.', 1),
  (107, 1, 48, 'Defect', '1', 'RESOLVED', '2011-10-10 23:00:41', 'Ссылки на участников проекта не работают', 'Ссылки на участников проекта не работают.', 1),
  (108, 1, 48, 'Task', '1', 'RESOLVED', '2011-10-10 23:02:45', 'Реализовать&quot;количество комментариев&quot;', 'Необходимо отображать количество комментариев, оставленные пользователем для каждого участника', 1),
  (128, 1, 48, 'Task', '2', 'RESOLVED', '2011-10-12 23:17:39', 'Произвести рефакторинг классов MyBugsPage ProjectBugsPage', 'В данных класса большое количество повторяющихся методов - вынести в базовый класс', 1),
  (129, 1, 48, 'Task', '2', 'RESOLVED', '2011-10-12 23:23:39', 'Реализовать удаление проектов', '1. При удалении проекта должны удаляться:<br />\r\n   1. 1. Все его подписчики<br />\r\n   1. 2. Все его айтемы<br />\r\n   1. 3. Все связанные элементы', 1),
  (136, 1, 22, 'Task', '1', 'NEW', '2011-10-14 01:17:11', '1', 'bgfgfghg', 0),
  (1137, 1, 22, 'Task', '1', 'NEW', '2011-10-14 01:22:15', 'bnmvbnmbnm', 'bnmvbnmvbnmvbnm', 0),
  (8688, 1, 48, 'Task', '2', 'RESOLVED', '2011-10-14 02:46:52', 'Реализовать вывод назначенных айтемов отдельно', 'На данный момент отображаются только созданные пользователем айтемы. Также нужно реализовать айтемы, которые назначены пользователю.', 1),
  (8689, 1, 22, 'Defect', '2', 'NEW', '2011-10-16 22:27:40', 'jhgjghj', 'fghjghj', 1),
  (8690, 1, 23, 'Task', '1', 'IDENTIFIED', '2011-10-16 22:28:47', 'jhgjghj', 'fghjghj', 1),
  (8691, 1, 23, 'Task', '1', 'NEW', '2011-10-17 20:11:48', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 1),
  (8692, 1, 23, 'Task', '1', 'NEW', '2011-10-17 20:12:56', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 1),
  (8693, 1, 23, 'Task', '1', 'NEW', '2011-10-17 23:03:44', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 1),
  (8694, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:21:01', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 1),
  (8695, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:21:29', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 1),
  (8696, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:22:38', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 0),
  (8697, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:23:01', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 0),
  (8698, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:23:32', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 0),
  (8699, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:24:00', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 0),
  (8700, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:24:13', 'fghghfgh', 'dfghdgfjhgjhkjjhk', 0),
  (8701, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:24:35', 'gfhgfh', 'fghfghdfghdh', 0),
  (8702, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:25:53', 'gfhgfh', 'fghfghdfghdh', 0),
  (8703, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:29:02', 'gfhgfh', 'fghfghdfghdh', 0),
  (8704, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:29:33', 'hdfgjghj', 'ghjfghfjghj', 0),
  (8705, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:31:21', 'hdfgjghjghfh', 'ghjfghfjghjfghdfgh', 0),
  (8706, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:32:02', 'hdfgjghjghfh', 'ghjfghfjghjfghdfghhfghgfh', 0),
  (8707, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:32:32', 'hdfgjghjghfh', 'ghjfghfjghjfghdfghhfghgfh', 0),
  (8708, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:32:49', 'fghfghf', 'hfhfg', 0),
  (8709, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:35:19', 'hjmhj,mjh,k', 'njchgn', 0),
  (8710, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:36:09', 'fdghdfghdg', 'fgfhgf', 0),
  (8711, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:38:34', 'fdghdfghdg', 'fgfhgf', 0),
  (8713, 1, 22, 'Task', '1', 'NEW', '2011-10-17 23:42:53', 'fgghfgh', 'gfhgth', 0),
  (8714, 1, 22, 'Task', '1', 'NEW', '2011-10-18 04:23:37', 'прарвпар', 'вапрапрвапр', 15),
  (8715, 1, 22, 'Task', '1', 'NEW', '2011-10-19 00:03:57', 'bncvbn', 'vbncvbnvnb', 7),
  (8716, 15, 22, 'Task', '1', 'NEW', '2011-10-19 00:51:21', 'fghfh', 'fghngfh', 0),
  (8717, 18, 49, 'Task', '1', 'NEW', '2011-10-19 21:14:11', 'првапрапр', 'арпрап', 0),
  (8718, 18, 49, 'Task', '1', 'NEW', '2011-10-19 21:14:22', 'рврпар', 'апрапрвапр', 18),
  (8719, 1, 22, 'Task', '1', 'NEW', '2011-10-19 21:17:36', 'fdgfdhg', 'dfdg', 0),
  (8720, 1, 22, 'Task', '1', 'NEW', '2011-10-19 21:18:13', 'gfhdghdgh', 'fgdfgdfg', 0),
  (8721, 18, 49, 'Defect', '2', 'ASSESSED', '2011-10-19 21:29:47', '85846546973596735849637', 'Блочное кеширование на стороне клиента\r\n\r\nВ последнее время в высоконагруженных сайтах стали все чаще применять технику Partial Caching или блочного кеширования. Достигается это, как правило, за счет применения, казалось бы уже давно забытого, SSI или близких ему технологий (например, ESI). Например, в связках Nginx + Memcached + SSI или Varnish + ESI.\r\n\r\nНедавно и на Хабре тоже появился топик в котором автор описывал данный метод кеширования.\r\n\r\nВ данном топике в 3м варианте решения автор предложил читателям топика привести свои варианты решения относительно данной задачи.\r\n\r\nЭтому, собственно, и посвящается этот топик.\r\n\r\nПостановка задачи\r\n\r\nВ большинстве случаев веб-страница состоит из блоков. Например, для простейшей страницы это блоки: шапка, подвал, правый или левый блок, и блок основного контента. Если сайт более сложный, то и соответственно, таких блоков будет больше, например для хабра это блоки: «последние посты», «последние коментарии», «похожие посты» и т.д. Соответственно возникают проблемы если мы хотим кешировать страницу на уровне представаления, т.е. непосредственно сгенерированный html, т.к. инвалидировать кеш для такой страницы пришлось бы при изменении любого из блоков, размещенного на данной странице.\r\nПоэтому в большинстве случаев применяется кеширование на уровне модели или данных, которые впоследствии заполняют некий шаблон страницы.\r\n\r\nЗдесь-то на помощь и приходит SSI, благодаря данной технологии мы собственно и разбиваем страницу на эти самые логические блоки, и кешируем каждый блок отдельно.\r\n\r\nПример страницы, использующей SSI вставки:\r\n<html>\r\n<body>\r\n\r\n<div class="header">\r\n<!--# include virtual="/header.php" -->\r\n</div>\r\n\r\n<div class="main_content">\r\n<!--# include virtual="/main.php" -->\r\n</div>\r\n\r\n\r\n<!--# include virtual="/footer.php" -->\r\n\r\n</body>\r\n</html>\r\n\r\n\r\n\r\nЗдесь-то, казалось бы и все хорошо, но есть несколько НО, на которых и хотелось бы задержаться.\r\n\r\nПроблемы\r\n\r\nПерсонализированные блоки — это блоки, содержащие персональные данные какого-то пользователя, например, «Привет, %username%!». На самом деле таких данных может быть очень много, взять ту же анкету на вконтакте. Не путайте их с блоками для авторизированных пользователей! Экземпляров вторых у вас в кеше всего два (для залогиненых и нет), для первых представление прийдется хранить в кеше для каждого пользователя! Cохраняя в мемкеше ключи такого вида {%block_id%}_{%PHPSESSID|user_id%}. А так как у нас кеширование на уровне представления, т.е. помимо данных мы храним еще и кучу html кода, который будет повторяться у нас для каждого пользователя, следовательно, расход памяти под кеш (Memcached) в данном случае очень сильно растет. Я уже не говорю про то, что в большой ферме мемкеш серверов, некоторые сервера время от времени отваливаются и даже с алгоритмом Consistent hashing проблемы все равно остаются\r\nНа разогревание кеша (обычно после перезагрузок, релизов новых версий и пр.) уходит очень много времени\r\n\r\n\r\nЧто предлагается?\r\n\r\nА предлагается, собственно следующий механизм кеширования:\r\nБлоки, отвечающие за представление, обобщаем для всех пользователей, т.е. выносим из них все персонифицированные данные, чтобы хранить всего один экземпляр блока в кеше для всех пользователей сайта. Что же остается от этих блоков? Правильно, остаются обычные темплейты представления, которые мы и будем передавать пользователю, а каждый пользователь заполнит данный шаблон сам, на стороне клиента, с помощью, Javascript. Т.е. клиент по запросу к странице получит страницу, состоящую из логических блоков, каждый блок, в свою очередь будет являтся шаблоном. Например\r\n<html>\r\n<body>\r\n    <div id="head_block">\r\n        Some {%personified%} data here\r\n    </div>\r\n    <div id="main_block">\r\n        Hello {%username%}!\r\n    </div>\r\n</body>\r\n</html>\r\n\r\n\r\n\r\nНу или, например, так\r\n<html>\r\n<body>\r\n    <div id="head_block">\r\n        Some <div id="{%personified%}"></div> data here\r\n    </div>\r\n    <div id="main_block">\r\n        Hello <div id="{%username%}"></div>!\r\n    </div>\r\n</body>\r\n</html>\r\n\r\n', 0),
  (8724, 1, 48, 'Defect', '2', 'RESOLVED', '2011-10-24 00:32:12', 'Если проект был удалён и мы получаем его список задач, то возникает ошибка.', 'Попытался просмотреть задачи проекта, который был удалён, вылезло исключение:\r\n\r\nFatal error: Uncaught exception Exception with message Проект не существует. Нельзя присвоить несуществующему проекту отчёты об ошибках in Z:home\tarakaning.ruwwwenginemodulesTarakaningLogicErrorReportsController.php:75 Stack trace: #0 Z:home\tarakaning.ruwwwenginemodulesTarakaningPageControllersBugsBasePage.php(45): ErrorReportsController->__construct(''520'') #1 Z:home\tarakaning.ruwwwenginemodulesTarakaningPageControllersMyBugsPage.php(19): BugsBasePage->onInit(true) #2 Z:home\tarakaning.ruwwwenginekernelSinglePage.php(26): MyBugsPage->onInit() #3 Z:home\tarakaning.ruwwwenginekernelHTMLPage.php(27): SinglePage->__construct(Object(TarakaningController)) #4 Z:home\tarakaning.ruwwwenginekernelModuleController.php(39): HTMLPage->__construct(Object(TarakaningController), MyBugsPage.tpl) #5 Z:home\tarakaning.ruwwwenginekernelModuleController.php(63): ModuleController->loadPages(Array) #6 Z:home\tarakaning.ruwwwenginekernelModuleController.php(68): ModuleController->loadPagesB in Z:home\tarakaning.ruwwwenginemodulesTarakaningLogicErrorReportsController.php on line 75', 1),
  (8725, 1, 48, 'Task', '2', 'NEW', '2011-10-24 00:37:27', 'Исследовать пользовательский интерфейс проекта Tarakaning', '1. Исследовать интерфейс проекта<br />\r\n2. Провести его анализ<br />\r\n3. Предложить изменения в интерфейсе<br />\r\n4. Задокументировать все предложения в комментариях к данной задаче.', 20),
  (8726, 1, 22, 'Task', '1', 'NEW', '2011-10-24 01:13:28', '''', '''''''', 0),
  (8727, 1, 22, 'Task', '1', 'NEW', '2011-10-24 01:13:55', '''', '''''''', 0),
  (8728, 1, 22, 'Task', '1', 'NEW', '2011-10-28 00:33:09', '''', '', 0),
  (8729, 1, 22, 'Defect', '1', 'NEW', '2011-10-28 00:35:53', '''''''', '''\r\n''\r\n''\r\n''\r\n', 0),
  (8730, 1, 48, 'Task', '2', 'RESOLVED', '2011-10-28 01:49:53', 'Добавить капчу при регистрации', 'При регистрации отсутствует капча. Нужно добавить её.', 1),
  (8731, 1, 48, 'Task', '2', 'IDENTIFIED', '2011-11-01 01:18:56', 'Реализовать отмену заявок, которые отправил пользователь', '1. Создать хранимую процедуру, которая очищает со списка\r\n2. Протестировать логику', 1),
  (8732, 1, 22, 'Task', '1', 'NEW', '2011-11-03 18:14:22', '''', '', 0);