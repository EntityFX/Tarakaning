{% extends "views/layouts/content.master.twig" %}

{% block body %}
<ul class="nav nav-tabs" id="item-tab">
    <li class="active"><a href="#edit_info" data-toggle="tab">Редактировать личные данные</a></li>
    <li><a href="#pass_change" data-toggle="tab">Сменить пароль</a></li>
    <li><a href="#settings" data-toggle="tab">Дополнительные настройки</a></li>
</ul>
<div class="tab-content">
    <div class="tab-pane active" id="edit_info">
        {{ C.Html.errorSummary(model,
                '<div class="alert alert-error">
                    <a class="close" data-dismiss="alert" href="#">&times;</a>',
                '</div>'
            )
        }} 
        
        
       {% set profileForm = this.beginWidget(
                'CActiveForm',
                {
                    'enableClientValidation' : true,
                    'enableAjaxValidation' : false,
                    'clientOptions' : {
                        'validateOnSubmit' : true
                    },
                    'htmlOptions' : {
                        'class' : 'form-horizontal'
                    },
                    'method' : 'post',
                    'errorMessageCssClass' : 'error'
                }
            )
        %}
            <fieldset>
                <legend>Редактирование профиля</legend>
            </fieldset>
            {% set div = this.beginWidget(
                    'EntityFxDivControlGroup',
                    {
                        'class' : 'control-group',
                        'form' : profileForm,
                        'model' : model,
                        'attribute' : 'firstname'
                    }
                )
            %}
                {{ profileForm.label(model,'firstname',{'class' : 'control-label'}) }}
                <div class="controls">
                    {{ profileForm.textField(model,'firstname',{'class' : 'input-large'}) }}
                    {{ profileForm.error(model,'firstname',{'class' : 'help-inline'}) }}
                </div>
            {% do this.endWidget() %}
            
            {% set div = this.beginWidget(
                    'EntityFxDivControlGroup',
                    {
                        'class' : 'control-group',
                        'form' : profileForm,
                        'model' : model,
                        'attribute' : 'secondName'
                    }
                )
            %}
                {{ profileForm.label(model,'secondName',{'class' : 'control-label'}) }}
                <div class="controls">
                    {{ profileForm.textField(model,'secondName',{'class' : 'input-large'}) }}
                    {{ profileForm.error(model,'secondName',{'class' : 'help-inline'}) }}
                </div>
            {% do this.endWidget() %}
            
            {% set div = this.beginWidget(
                    'EntityFxDivControlGroup',
                    {
                        'class' : 'control-group',
                        'form' : profileForm,
                        'model' : model,
                        'attribute' : 'lastName'
                    }
                )
            %}
                {{ profileForm.label(model,'lastName',{'class' : 'control-label'}) }}
                <div class="controls">
                    {{ profileForm.textField(model,'lastName',{'class' : 'input-large'}) }}
                    {{ profileForm.error(model,'lastName',{'class' : 'help-inline'}) }}
                </div>
            {% do this.endWidget() %}

            {% set div = this.beginWidget(
                    'EntityFxDivControlGroup',
                    {
                        'class' : 'control-group',
                        'form' : profileForm,
                        'model' : model,
                        'attribute' : 'email'
                    }
                )
            %}
                {{ profileForm.label(model,'email',{'class' : 'control-label'}) }}
                <div class="controls">
                    {{ profileForm.textField(model,'email',{'class' : 'input-large'}) }}
                    {{ profileForm.error(model,'email',{'class' : 'help-inline'}) }}
                </div>
            {% do this.endWidget() %}
            
            <div class="form-actions">
                <button class="btn btn-primary" type="submit" name="save_profile">
                    <i class="icon-hdd icon-white"></i>
                    Сохранить
                </button>
            </div>
        {% do this.endWidget() %}
    </div>
    <div class="tab-pane" id="pass_change">
        <form class="form-horizontal" action="/profile/edit/newpass/" method="post">
            <fieldset>
                <legend>����� ������</legend>
            </fieldset>
            <div class="control-group">
                <label class="control-label" for="oldPassword">������ ������</label>
                <div class="controls">
                    <input type="password" class="input-large" name="oldPassword" id="oldPassword" />
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="newPassword">����� ������</label>
                <div class="controls">
                    <input type="password" class="input-large" name="newPassword" id="newPassword" />
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="newPasswordRepeat">������ ������ ������</label>
                <div class="controls">
                    <input type="password" class="input-large" name="newPasswordRepeat" id="newPasswordRepeat" />
                </div>
            </div>
            <div class="form-actions">
                <button class="btn btn-primary" type="submit" name="save_btn">
                    <i class="icon-hdd icon-white"></i>
                    ���������
                </button>
            </div>
        </form>
    </div>
    <div class="tab-pane" id="settings">
        <form class="form-horizontal" action="/profile/edit/" method="post">
            <fieldset>
                <legend>����� ���������</legend>
            </fieldset>
            <div class="control-group">
                <label class="control-label" for="defaultProject">������ ��-���������</label>
                <div class="controls">
                    <select id="defaultProject" name="defaultProject" {if $PROJECTS.PROJECTS_LIST eq NULL}disabled="disabled"{/if}>
                        {if $PROJECTS.PROJECTS_LIST neq NULL}
                            {html_options options=$PROJECTS.PROJECTS_LIST selected=$PROJECTS.selected}
                        {/if}
                    </select>
                </div>
            </div>
            <div class="form-actions">
                <button class="btn btn-primary" type="submit" name="save_project" {if $PROJECTS.PROJECTS_LIST eq NULL}disabled="disabled"{/if}>
                    <i class="icon-hdd icon-white"></i>
                    ���������
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}